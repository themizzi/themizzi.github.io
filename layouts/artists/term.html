{{ define "main" }}
<div class="container">
    <h1>{{ .Title }}</h1>
    {{ .Content }}
    {{ range .Pages.GroupBy "Section" }}
    {{ $section := $.Site.GetPage "section" .Key}}
    <h2>{{ $section.Title }}</h2>
    {{ if eq .Key "discography" }}
    <ul>
        {{ $albums := slice }}
        {{ range $section.RegularPagesRecursive }}
        {{ if in .Params.artists $.Data.Term }}
        {{ $albums = union $albums (slice .Parent) }}
        {{ end}}
        {{ end }}
        {{ range sort $albums "Date" "desc" }}
        <li>
            <a href="{{ .Permalink }}">{{ .Title }}</a>
        </li>
        {{ end }}
    </ul>
    {{ else }}
    {{ range .Pages }}
    <div>
        <a href="{{ .Permalink }}">{{ .Title }}</a>
    </div>
    {{ end }}
    {{ end }}
    {{ end }}
</div>
{{ end}}